(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,a){e.exports=a(31)},24:function(e,t,a){},26:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(15),s=a.n(l),o=a(34),i=(a(24),a(2)),c=a(3),m=a(5),u=a(4),d=a(6),h=(a(26),a(32)),p=a(36),b=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={permissions:["foo"],loggedin:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getUserInfo",value:function(){var e=this;fetch(window.API_URL+"/auth/permissions",{credentials:"include"}).then(function(t){return 401===t.status?e.setState({loggedin:!1}):e.setState({loggedin:!0}),t.json()}).then(function(t){e.setState({permissions:t})})}},{key:"componentDidMount",value:function(){this.getUserInfo()}},{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&this.onRouteChanged()}},{key:"onRouteChanged",value:function(){this.getUserInfo()}},{key:"render",value:function(){return r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light fixed-top"},r.a.createElement(h.a,{className:"navbar-brand",to:"/"},"Red Team Dashboard"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNav"},this.state.loggedin&&r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item active"},r.a.createElement(h.a,{className:"nav-link",to:"/Teams"},"Teams")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(h.a,{className:"nav-link",to:"/Hosts"},"Hosts")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(h.a,{className:"nav-link",to:"/Vulnerabilities"},"Vulnerabilities")),"function"===typeof this.state.permissions.indexOf&&this.state.permissions.indexOf("admin")>-1&&r.a.createElement("li",{className:"navbar-nav"},r.a.createElement(h.a,{className:"nav-link",to:"/UserManagement"},"User Management"))),!1===this.state.loggedin?r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(h.a,{className:"nav-link",to:"/Register"},"Register")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(h.a,{className:"nav-link",to:"/Login"},"Login ",this.state.loggedin))):r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",null,window.user),r.a.createElement("li",{className:"nav-item"},r.a.createElement(h.a,{className:"nav-link",to:"/Logout"},"Logout")))))}}]),t}(n.Component),v=Object(p.a)(b),f=a(35),E=a(33);function y(e){return new Promise(function(t,a){fetch(window.API_URL+"/auth/permissions",{credentials:"include"}).then(function(e){return"401"===e.status&&t(!1),e.json()},function(e){return a(e)}).then(function(a){a.indexOf(e)>-1?t(!0):t(!1)})})}var g=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"portContainer"},this.props.port,"/",this.props.protocol," : ",this.props.service)}}]),t}(n.Component),O=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).submitComment=function(e){e.preventDefault();var t={};t.text=e.target.newComment.value,fetch(window.API_URL+"/"+a.props.commentType+"/"+a.props.scope+"/comments",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(e.target.newComment.value="")},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"commentsContainer"},r.a.createElement("form",{onSubmit:this.submitComment},r.a.createElement("table",{className:"table table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Comment"),r.a.createElement("th",null,"Date"),r.a.createElement("th",null,"User"))),r.a.createElement("tbody",null,this.props.commentArray.map(function(e){return r.a.createElement("tr",{key:e._id},r.a.createElement("td",null,e.text),r.a.createElement("td",null,e.date),r.a.createElement("td",null,e.user))}),r.a.createElement("tr",null,r.a.createElement("td",null," ",r.a.createElement("input",{type:"text",className:"form-text form-control",id:"newComment",placeholder:"New comment..."})),r.a.createElement("td",null),r.a.createElement("td",null)))),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit")))}}]),t}(n.Component);O.defaultProps={commentArray:[]};var j=O,k=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).toggleModal=function(){console.log("toggling modal state"),a.setState({isOpen:!a.state.isOpen})},a.submitVulnerability=function(e){alert("in onSubmit"),e.preventDefault();var t={};t.vulnerability=e.target.newVulnerability.value,t.notes=e.target.newNotes.value,t.severity=e.target.newSeverity.value,fetch(window.API_URL+"/vulnerability/"+a.props.host+"/"+a.props.port,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(e.target.newVulnerability.value="").then(e.target.newNotes.value="").then(a.setState({isOpen:!1}))},a.state={isOpen:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("button",{type:"button",className:"btn btn-primary","data-toggle":"modal","data-target":"#exampleModalCenter",onClick:this.toggleModal},"Add Vulnerability"),this.state.isOpen&&r.a.createElement("div",{className:"modal fade show ",style:{display:"block",backgroundColor:"rgba(0,0,0,0.5)"},id:"exampleModalCenter",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-dialog-centered modal-lg",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalLongTitle"},"Add Vulnerability"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true",onClick:this.toggleModal},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("form",{onSubmit:this.submitVulnerability},r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Vulnerability"),r.a.createElement("th",null,"Notes"),r.a.createElement("th",null,"Severity"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("input",{type:"text",className:"form-text form-control",id:"newVulnerability",placeholder:"Vulnerability title..."})),r.a.createElement("td",null,r.a.createElement("input",{type:"text",className:"form-text form-control",id:"newNotes",placeholder:"Vulnerability notes..."})),r.a.createElement("td",null,r.a.createElement("select",{id:"newSeverity"},r.a.createElement("option",{value:"Admin Access"},"Admin Access"),r.a.createElement("option",{value:"Regular User Access"},"Regular User Access"),r.a.createElement("option",{value:"Arbitrary File Write"},"Arbitrary File Write"),r.a.createElement("option",{value:"Arbitrary File Read"},"Arbitrary File Read"),r.a.createElement("option",{value:"Database Read"},"Database Read"),r.a.createElement("option",{value:"Database Write"},"Database Write"),r.a.createElement("option",{value:"Information Disclosure"},"Information Disclosure"),r.a.createElement("option",{value:"Other"},"Other (note details in notes section)")))))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close"),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit"))))))))}}]),t}(n.Component),N=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).toggleDetected=function(e){var t={detected:e.target.checked};fetch(window.API_URL+"/vulnerability/"+a.props.host+"/"+a.props.port+"/"+e.target.value,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){e.json()})},a.toggleCurrent=function(e){var t={current:e.target.checked};fetch(window.API_URL+"/vulnerability/"+a.props.host+"/"+a.props.port+"/"+e.target.value,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){e.json()})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"commentsContainer"},this.props.vulnerabilities.length>0&&r.a.createElement("table",{className:"table table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Vulnerability"),r.a.createElement("th",null,"Notes"),r.a.createElement("th",null,"Severity"),r.a.createElement("th",null,"Date"),r.a.createElement("th",null,"Detected"),r.a.createElement("th",null,"Current"),r.a.createElement("th",null,"User"))),r.a.createElement("tbody",null,this.props.vulnerabilities.map(function(t){return r.a.createElement("tr",{key:t._id},r.a.createElement("td",null,t.vulnerability),r.a.createElement("td",null,t.notes),r.a.createElement("td",null,t.severity),r.a.createElement("td",null,t.date),r.a.createElement("td",null,r.a.createElement("input",{className:"form-check-input",type:"checkbox",checked:t.detected,name:"detected",value:t._id,onChange:e.toggleDetected})),r.a.createElement("td",null,r.a.createElement("input",{className:"form-check-input",type:"checkbox",checked:t.current,name:"current",value:t._id,onChange:e.toggleCurrent})),r.a.createElement("td",null,t.user))}))),r.a.createElement(k,{host:this.props.host,port:this.props.port}))}}]),t}(n.Component);N.defaultProps={commentArray:[]};var w=N,C=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).toggleModal=function(){console.log("toggling modal state"),a.setState({isOpen:!a.state.isOpen})},a.state={isOpen:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("span",null,r.a.createElement("i",{className:"fas fa-history",onClick:this.toggleModal}),this.state.isOpen&&r.a.createElement("div",{className:"modal fade show ",style:{display:"block",backgroundColor:"rgba(0,0,0,0.5)"},id:"exampleModalCenter",tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog modal-dialog-centered modal-lg",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalLongTitle"},"Port HIstory"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true",onClick:this.toggleModal},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"State"),r.a.createElement("th",null,"Start"),r.a.createElement("th",null,"End"))),r.a.createElement("tbody",null,this.props.history.map(function(e){return r.a.createElement("tr",{key:e._id},r.a.createElement("td",null,e.state),r.a.createElement("td",null,e.start),r.a.createElement("td",null,e.end))}))),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",onClick:this.toggleModal},"Close")))))))}}]),t}(n.Component),P=function(e){function t(e){var a;Object(i.a)(this,t),a=Object(m.a)(this,Object(u.a)(t).call(this,e));var n=!1;if(console.log(a.props.port),"open"===a.props.port.state)for(var r=0;r<a.props.port.vulnerabilities.length;r++)a.props.port.vulnerabilities[r].current&&(n=!0,console.log("hacked"));return a.state={hacked:n},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("tr",{key:this.props.port._id,className:[this.props.port.state,this.state.hacked?"hacked":"clean"].join(" ")},r.a.createElement("td",null,this.props.port.port,"/",this.props.port.protocol," ",this.props.port.history.length>0&&r.a.createElement(C,{history:this.props.port.history})),r.a.createElement("td",null,this.props.port.service),r.a.createElement("td",null,this.props.summary?this.props.port.vulnerabilities.length>0&&r.a.createElement("i",{className:"fas fa-bug"}):r.a.createElement(w,{port:this.props.port.port,vulnerabilities:this.props.port.vulnerabilities,host:this.props.ip})))}}]),t}(n.Component),I=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},"Open Ports"),r.a.createElement("div",{className:"card-body"},r.a.createElement("table",{className:"table table-striped table-sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Port"),r.a.createElement("th",null,"Service"),r.a.createElement("th",null,"Vulns"))),r.a.createElement("tbody",null,this.props.openPorts.map(function(t){return r.a.createElement(P,{port:t,summary:e.props.summary,ip:e.props.ip,key:t._id})})))))}}]),t}(n.Component),S=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"createPort",value:function(e){return r.a.createElement(g,{port:e.port,protocol:e.protocol,service:e.service,key:e._id})}},{key:"createPorts",value:function(e){return e.map(this.createPort)}},{key:"handleClick",value:function(e,t){t.stopPropagation()}},{key:"componentDidCatch",value:function(e,t){console.log(e,t)}},{key:"render",value:function(){return r.a.createElement("div",{className:"hostContainer card",onClick:this.handleClick.bind(this,this.props.ip)},r.a.createElement("h5",{className:"card-title"},this.props.ip),r.a.createElement("h5",{className:"card-subtitle"},this.props.hostname),r.a.createElement("div",{className:"card-body"},null!==this.props.comments&&this.props.comments.length>0&&r.a.createElement("i",{className:"fas fa-comment"}),this.props.openPorts.length>0&&r.a.createElement(I,{openPorts:this.props.openPorts,ip:this.props.ip,summary:this.props.summary}),!this.props.summary&&r.a.createElement(j,{commentArray:this.props.comments,commentType:"hosts",scope:this.props.ip})))}}]),t}(n.Component),_=Object(p.a)(S),A=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={hosts:[],team:{comments:[]}},"undefined"!==typeof a.props.id?a.state.id=a.props.id:a.state.id=a.props.match.params.id,a.props.summary,!0===a.props.summary?a.state.summary=!0:a.state.summary=!1,a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.teamInterval=setInterval(function(){return fetch(window.API_URL+"/teams/"+e.state.id,{credentials:"include"}).then(function(t){if(t.ok)return t.json();e.props.history.push("/Login")}).then(function(t){return e.setState({team:t})})},5e3),this.hostsInterval=setInterval(function(){return fetch(window.API_URL+"/hosts/team/"+e.state.id,{credentials:"include"}).then(function(t){if(t.ok)return t.json();e.props.history.push("/Login")}).then(function(t){return e.setState({hosts:t})})},5e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.teamInterval),clearInterval(this.hostsInterval)}},{key:"createHost",value:function(e){return r.a.createElement(_,{hostname:e.hostname,ip:e.ip,openPorts:e.openPorts,key:e._id})}},{key:"createHosts",value:function(e){return e.map(this.createHost)}},{key:"handleClick",value:function(e){this.props.history.push("/team/"+e)}},{key:"render",value:function(){var e,t=this;return r.a.createElement("div",{className:"teamContainer shadow p-3 mb-5 bg-white rounded card",onClick:this.handleClick.bind(this,this.state.id)},r.a.createElement("h1",{className:"card-title"},"Name: ",this.state.team.name),r.a.createElement("h2",{className:"card-subtitle"},"Range: ",this.state.team.range),this.state.team.comments.length>0&&r.a.createElement("i",{className:"fas fa-comment"}),r.a.createElement("br",null),(e=this.state.hosts,e.sort(function(e,t){for(var a=e.ip.split("."),n=t.ip.split("."),r=0;r<a.length;r++){if((a[r]=parseInt(a[r]))<(n[r]=parseInt(n[r])))return-1;if(a[r]>n[r])return 1}return 0})).map(function(e){return"up"===e.state&&r.a.createElement(_,{hostname:e.hostname,ip:e.ip,openPorts:e.openPorts,comments:e.comments,key:e._id,summary:t.state.summary})}),!this.state.summary&&r.a.createElement(j,{commentArray:this.state.team.comments,commentType:"teams",scope:this.state.team._id}))}}]),t}(n.Component),x=Object(p.a)(A),T=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={teams:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;y("view").then(function(t){t||e.props.history.push("/Login")}),this.interval=setInterval(function(){return fetch(window.API_URL+"/teams",{credentials:"include"}).then(function(t){if(t.ok)return t.json();e.props.history.push("/Login")}).then(function(t){return e.setState({teams:t})})},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"createTeam",value:function(e){return r.a.createElement(x,{name:e.name,range:e.range,key:e.name,id:e._id,summary:!0})}},{key:"createTeams",value:function(e){return e.map(this.createTeam)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"teamsContainer"},this.createTeams(this.state.teams)))}}]),t}(n.Component),L=a(18),U=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t={},a=document.getElementById("newTeamForm");t.name=a.name.value,t.range=a.range.value,fetch(window.API_URL+"/teams",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()})},a.handleChange=function(e){a.setState(Object(L.a)({},"newTeam"[e.target.name],e.target.value))},a.state={teams:[],newTeam:{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){return fetch(window.API_URL+"/teams",{credentials:"include"}).then(function(t){if(t.ok)return t.json();e.props.history.push("/Login")}).then(function(t){return e.setState({teams:t})})},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"handleClick",value:function(e){this.props.history.push("/team/"+e)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container"},r.a.createElement("table",{className:"table table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Team Name"),r.a.createElement("th",null,"IP Range"))),r.a.createElement("tbody",null,this.state.teams.map(function(t){return r.a.createElement("tr",{key:t.name,onClick:e.handleClick.bind(e,t._id)},r.a.createElement("td",null,t.name),r.a.createElement("td",null,t.range))}))),r.a.createElement("div",null,r.a.createElement("h1",null,"Create New Team"),r.a.createElement("form",{onSubmit:this.handleSubmit,id:"newTeamForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"name"},"Team Name"),r.a.createElement("input",{type:"text",className:"form-text",id:"name",placeholder:"Enter team name"})),r.a.createElement("div",{className:"from-group"},r.a.createElement("label",{htmlFor:"range"},"IP Address Range"),r.a.createElement("input",{type:"text",className:"form-text",id:"range",placeholder:"Enter team IP Address Range"})),r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit"))))}}]),t}(n.Component),R=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).chooseHost=function(e){a.setState({selectedHost:e.target.value})},a.state={hosts:[],selectedHost:null},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){return fetch("http://127.0.0.1:3001/hosts",{credentials:"include"}).then(function(e){return e.json()}).then(function(t){return e.setState({hosts:t})})},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Hosts!"),r.a.createElement("select",{onChange:this.chooseHost},this.state.hosts.map(function(e,t){return r.a.createElement("option",{value:t,key:t},e.ip)})),this.state.selectedHost&&r.a.createElement(_,{hostname:this.state.hosts[this.state.selectedHost].hostname,ip:this.state.hosts[this.state.selectedHost].ip,openPorts:this.state.hosts[this.state.selectedHost].openPorts,comments:this.state.hosts[this.state.selectedHost].comments,key:this.state.hosts[this.state.selectedHost]._id,summary:!1}))}}]),t}(n.Component),D=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault();var t={},n=document.getElementById("registerForm");t.email=n.email.value,t.handle=n.handle.value,t.password=n.password.value,fetch(window.API_URL+"/auth/register",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return e.json()}).then(a.props.history.push("/Login"))},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header text-center"},"Register"),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",{onSubmit:this.handleSubmit,id:"registerForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email Address"),r.a.createElement("input",{type:"email",className:"form-control",id:"email",placeholder:"Enter email..."})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"handle"},"Handle"),r.a.createElement("input",{type:"text",className:"form-control",id:"handle",placeholder:"Enter handle..."})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"password",placeholder:"Password..."})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit"))))))}}]),t}(n.Component),M=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"alert alert-danger"},"Error: ",this.props.message)}}]),t}(n.Component),F=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault();var t={},n=document.getElementById("loginForm");t.email=n.email.value,t.password=n.password.value,fetch(window.API_URL+"/auth/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){200===e.status?(a.props.history.push("/"),e.json().then(function(e){window.user=e.user})):e.json().then(function(e){a.setState({error:e.error})})})},a.state={error:""},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header text-center"},"Login"),r.a.createElement("div",{className:"card-body"},""!==this.state.error&&r.a.createElement(M,{message:this.state.error}),r.a.createElement("form",{onSubmit:this.handleSubmit,id:"loginForm"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"Email Address"),r.a.createElement("input",{type:"email",className:"form-control",id:"email",placeholder:"Enter email..."})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"password",placeholder:"Password..."})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Submit"))))))}}]),t}(n.Component),H=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={loggedin:"true"},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(window.API_URL+"/auth/logout",{credentials:"include"}).then(function(e){return e.json()}).then(function(t){e.setState({loggedin:!1}),window.user="",e.props.history.push("/Login")})}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header text-center"},"Logout"),r.a.createElement("div",{className:"card-body"},this.state.loggedin?r.a.createElement("div",null,"You are being logged out"):r.a.createElement("div",null,"You have been logged out"))))}}]),t}(n.Component),V=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).toggleActive=function(e){var t={active:e.target.checked};fetch(window.API_URL+"/auth/user/"+a.props.user._id,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){e.json()})},a.togglePermission=function(e){var t=e.target.name,n=e.target.checked,r=a.props.user.permissions;if(n)r.push(t);else{var l=r.indexOf(t);r.splice(l,1)}fetch(window.API_URL+"/auth/user/"+a.props.user._id,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({permissions:r})}).then(function(e){e.json()})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("tr",{key:this.props.user._id},r.a.createElement("td",null,this.props.user.email),r.a.createElement("td",null,this.props.user.handle),r.a.createElement("td",{className:"text-center"},r.a.createElement("input",{className:"form-check-input",type:"checkbox",checked:this.props.user.active,onChange:this.toggleActive})),r.a.createElement("td",null,r.a.createElement("div",{className:"form-check"},r.a.createElement("input",{form:this.props.user._id,className:"form-check-input",type:"checkbox",checked:this.props.user.permissions.indexOf("admin")>-1,name:"admin",id:"admin"+this.props.user._id,onChange:this.togglePermission}),r.a.createElement("label",{className:"form-check-label",htmlFor:"admin"+this.props.user._id},"Admin")),r.a.createElement("div",{className:"form-check"},r.a.createElement("input",{form:this.props.user._id,className:"form-check-input",type:"checkbox",checked:this.props.user.permissions.indexOf("view")>-1,name:"view",id:"view"+this.props.user._id,onChange:this.togglePermission}),r.a.createElement("label",{className:"form-check-label",htmlFor:"view"+this.props.user._id},"View")),r.a.createElement("div",{className:"form-check"},r.a.createElement("input",{htmlFor:this.props.user._id,className:"form-check-input",type:"checkbox",checked:this.props.user.permissions.indexOf("hacker")>-1,name:"hacker",id:"hacker"+this.props.user._id,onChange:this.togglePermission}),r.a.createElement("label",{className:"form-check-label",htmlFor:"hacker"+this.props.user._id},"Hacker")),r.a.createElement("div",{className:"form-check"},r.a.createElement("input",{form:this.props.user._id,className:"form-check-input",type:"checkbox",checked:this.props.user.permissions.indexOf("scanner")>-1,name:"scanner",id:"scanner"+this.props.user._id,onChange:this.togglePermission}),r.a.createElement("label",{className:"form-check-label",htmlFor:"scanner"+this.props.user._id},"Scanner"))))}}]),t}(n.Component),W=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={users:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;y("admin").then(function(t){t||e.props.history.push("/Login")}),this.interval=setInterval(function(){return fetch(window.API_URL+"/auth/users",{credentials:"include"}).then(function(t){if(t.ok)return t.json();e.props.history.push("/Login")}).then(function(t){return e.setState({users:t})})},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("table",{className:"table table-striped table-sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Email"),r.a.createElement("th",null,"Handle"),r.a.createElement("th",null,"Active"),r.a.createElement("th",null,"Permissions"))),r.a.createElement("tbody",null,this.state.users.map(function(e){return r.a.createElement(V,{key:e._id,user:e})}))))}}]),t}(n.Component),J=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={vulns:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.interval=setInterval(function(){return fetch(window.API_URL+"/vulnerability",{credentials:"include"}).then(function(t){if(t.ok)return t.json();e.props.history.push("/Login")}).then(function(t){return e.setState({vulns:t})})},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){return r.a.createElement("div",null,this.state.vulns.map(function(e){return r.a.createElement("div",{key:e.host},r.a.createElement("h2",null,e.host),e.ports&&e.ports.map(function(t){return r.a.createElement("div",{key:t._id},r.a.createElement("h3",null,t.port),r.a.createElement(w,{port:t.port,vulnerabilities:t.vulnerabilities,host:e.ip}))}))}))}}]),t}(n.Component),B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).state={teams:[]},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"loggedIn",value:function(){fetch(window.API_URL+"/auth/permissions",{credentials:"include"}).then(function(e){return!!e.ok})}},{key:"requireAuth",value:function(e,t){this.loggedIn()||t({pathname:"/Login"})}},{key:"render",value:function(){return r.a.createElement("div",{className:"jumbotron"},r.a.createElement(f.a,null,r.a.createElement(E.a,{exact:!0,path:"/",component:T}),r.a.createElement(E.a,{path:"/Teams",component:U}),r.a.createElement(E.a,{path:"/Team/:id",component:x}),r.a.createElement(E.a,{path:"/Hosts",component:R}),r.a.createElement(E.a,{path:"/Host/:ip",component:R}),r.a.createElement(E.a,{path:"/Vulnerabilities",component:J}),r.a.createElement(E.a,{path:"/Register",component:D}),r.a.createElement(E.a,{path:"/Login",component:F}),r.a.createElement(E.a,{path:"/Logout",component:H}),r.a.createElement(E.a,{path:"/UserManagement",component:W})))}}]),t}(n.Component),Y=function(e){function t(){return Object(i.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(v,null),r.a.createElement(B,null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(o.a,null,r.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[19,2,1]]]);
//# sourceMappingURL=main.eb6f34c4.chunk.js.map